<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ä»Šæ—¥è¯­ä¼´å­¦ä¹ </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            width: 100vw;
            min-height: 100vh;
            font-family: "å¾®è½¯é›…é»‘", sans-serif;
            background-color: #f0f8ff;
            padding-bottom: 80px;
            overflow-x: hidden;
        }
        .page-container {
            width: 100%;
            min-height: calc(100vh - 80px);
            padding: 0 20px;
        }

        /* é¡µé¢æ ‡é¢˜ */
        .page-title {
            padding: 20px 0;
            font-size: 18px;
            font-weight: bold;
            color: #333;
            text-align: center;
        }

        /* åœºæ™¯é€‰æ‹©æ  */
        .scene-section {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            scrollbar-width: none;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .scene-section::-webkit-scrollbar {
            display: none;
        }
        .scene-btn {
            padding: 8px 18px;
            background-color: #fff;
            border-radius: 20px;
            font-size: 14px;
            color: #333;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            white-space: nowrap;
            border: none;
            transition: all 0.2s;
        }
        .scene-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 2px 10px rgba(90, 78, 187, 0.1);
        }
        .scene-btn.active {
            background: linear-gradient(to right, #312fac, #676cb8);
            color: #fff;
        }

        /* è§†é¢‘äº’åŠ¨åŒºåŸŸ */
        .video-interact-section {
            margin-bottom: 25px;
        }
        .video-card {
            background-color: #fff;
            border-radius: 20px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.06);
            position: relative;
            overflow: hidden;
            transition: all 0.3s;
        }
        .video-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.08);
        }
        /* åœºæ™¯èƒŒæ™¯ */
        .scene-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(rgba(0,0,0,0.1), rgba(0,0,0,0.3)), url('') center/cover no-repeat;
            z-index: 1;
            transition: all 0.5s;
        }
        .scene-bg.office {
            background: linear-gradient(rgba(0,0,0,0.2), rgba(0,0,0,0.4)), url('') center/cover no-repeat;
            background-color: #e8f0ff;
        }
        .scene-bg.restaurant {
            background: linear-gradient(rgba(0,0,0,0.2), rgba(0,0,0,0.4)), url('') center/cover no-repeat;
            background-color: #fff0e8;
        }
        .scene-bg.airport {
            background: linear-gradient(rgba(0,0,0,0.2), rgba(0,0,0,0.4)), url('') center/cover no-repeat;
            background-color: #e8fff8;
        }
        /* å®æ—¶è¡¨æƒ…åé¦ˆ */
        .emotion-feedback {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: rgba(255,255,255,0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            z-index: 3;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        .emotion-feedback.encourage {
            color: #5a4ebb;
        }
        .emotion-feedback.confused {
            color: #ff6b6b;
        }
        .emotion-feedback.happy {
            color: #ffc107;
        }

        /* å­—å¹• & å†…å®¹åŒº */
        .subtitle-section {
            margin-bottom: 20px;
            position: relative;
            z-index: 3;
        }
        .subtitle-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .subtitle-mode {
            display: flex;
            gap: 8px;
        }
        .subtitle-btn {
            padding: 5px 12px;
            border-radius: 15px;
            border: none;
            font-size: 12px;
            cursor: pointer;
            background-color: rgba(255,255,255,0.8);
            color: #333;
            transition: all 0.2s;
        }
        .subtitle-btn.active {
            background: linear-gradient(to right, #312fac, #676cb8);
            color: #fff;
        }
        .word-collect-btn {
            padding: 5px 12px;
            border-radius: 15px;
            border: none;
            font-size: 12px;
            cursor: pointer;
            background-color: rgba(255,255,255,0.8);
            color: #5a4ebb;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.2s;
        }
        .word-collect-btn:hover {
            background-color: #e0e8ff;
        }
        /* åŒè¯­å­—å¹•æ  */
        .subtitle-bar {
            background-color: rgba(0,0,0,0.6);
            color: #fff;
            padding: 12px 15px;
            border-radius: 12px;
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 15px;
        }
        .subtitle-bar.original-only {
            color: #fff;
        }
        .subtitle-bar.translation-only {
            color: #fff;
        }
        /* é‡ç‚¹è¯æ ‡æ³¨ */
        .key-word {
            color: #ffc107;
            font-weight: bold;
            cursor: pointer;
            text-decoration: underline;
            text-decoration-style: dotted;
        }
        /* å¯¹è¯è„šæœ¬ */
        .script-content {
            background-color: rgba(255,255,255,0.9);
            border-radius: 12px;
            padding: 15px;
            font-size: 14px;
            line-height: 1.6;
            max-height: 150px;
            overflow-y: auto;
            margin-bottom: 10px;
        }
        .script-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        .script-btn {
            padding: 5px 12px;
            border-radius: 15px;
            border: none;
            font-size: 12px;
            cursor: pointer;
            background-color: #e0e8ff;
            color: #5a4ebb;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.2s;
        }
        .script-btn:hover {
            background-color: #5a4ebb;
            color: #fff;
        }

        /* è§†é¢‘æ§åˆ¶åŠŸèƒ½åŒº */
        .video-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-top: 1px solid rgba(255,255,255,0.2);
            margin-top: 10px;
            position: relative;
            z-index: 3;
        }
        .video-control-group {
            display: flex;
            gap: 10px;
        }
        .video-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            background-color: rgba(255,255,255,0.9);
            color: #5a4ebb;
            font-size: 16px;
            transition: all 0.2s;
        }
        .video-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .play-btn {
            background: linear-gradient(to right, #312fac, #676cb8);
            color: #fff;
        }
        .speed-control {
            padding: 5px 12px;
            border-radius: 15px;
            border: none;
            font-size: 12px;
            cursor: pointer;
            background-color: rgba(255,255,255,0.9);
            color: #5a4ebb;
            transition: all 0.2s;
        }
        .speed-control:hover {
            background-color: #e0e8ff;
        }

        /* å¯¹è¯äº’åŠ¨åŒº */
        .chat-interact-section {
            margin-bottom: 25px;
        }
        .chat-card {
            background-color: #fff;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.06);
            transition: all 0.3s;
        }
        .chat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.08);
        }
        /* å¯¹è¯å†å² */
        .chat-history {
            height: 200px;
            overflow-y: auto;
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 12px;
            background-color: #f8f9ff;
        }
        .chat-item {
            margin-bottom: 12px;
            max-width: 85%;
        }
        .chat-item.companion {
            align-self: flex-start;
        }
        .chat-item.me {
            align-self: flex-end;
            margin-left: auto;
        }
        .chat-bubble {
            padding: 10px 15px;
            border-radius: 18px;
            line-height: 1.4;
            font-size: 14px;
        }
        .chat-bubble.companion {
            background-color: #e0e8ff;
            color: #333;
            border-top-left-radius: 5px;
        }
        .chat-bubble.me {
            background: linear-gradient(to right, #312fac, #676cb8);
            color: #fff;
            border-top-right-radius: 5px;
        }
        .chat-time {
            font-size: 10px;
            color: #999;
            margin-top: 3px;
            padding: 0 10px;
        }
        /* å¤‡é€‰å›å¤ */
        .reply-options {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        .reply-option {
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid #e0e8ff;
            font-size: 14px;
            color: #5a4ebb;
            cursor: pointer;
            background-color: #fff;
            transition: all 0.2s;
        }
        .reply-option:hover {
            background-color: #e0e8ff;
            transform: scale(1.03);
        }
        .reply-option.selected {
            background: linear-gradient(to right, #312fac, #676cb8);
            color: #fff;
            border-color: #5a4ebb;
        }
        /* å‘è¨€æ¡†åŒºåŸŸ */
        .input-area {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }
        .voice-input-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: none;
            background-color: #e0e8ff;
            color: #5a4ebb;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            flex-shrink: 0;
            transition: all 0.2s;
        }
        .voice-input-btn.recording {
            background-color: #ff6b6b;
            color: #fff;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .chat-input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid #e0e8ff;
            border-radius: 25px;
            font-size: 14px;
            resize: none;
            height: 45px;
            outline: none;
            transition: all 0.2s;
        }
        .chat-input:focus {
            border-color: #5a4ebb;
            box-shadow: 0 0 0 2px rgba(90, 78, 187, 0.1);
        }
        .send-btn {
            padding: 12px 20px;
            border-radius: 25px;
            border: none;
            background: linear-gradient(to right, #312fac, #676cb8);
            color: #fff;
            font-size: 14px;
            cursor: pointer;
            flex-shrink: 0;
            transition: all 0.2s;
        }
        .send-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(90, 78, 187, 0.2);
        }
        .send-btn:disabled {
            background-color: #999;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        /* è¾…åŠ©åŠŸèƒ½æŒ‰é’® */
        .aux-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }
        .aux-btn {
            padding: 8px 15px;
            border-radius: 20px;
            border: none;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .restart-btn {
            background-color: #ffe8e8;
            color: #ff6b6b;
        }
        .restart-btn:hover {
            background-color: #ff6b6b;
            color: #fff;
        }
        .analysis-btn {
            background-color: #e0e8ff;
            color: #5a4ebb;
        }
        .analysis-btn:hover {
            background-color: #5a4ebb;
            color: #fff;
        }

        /* åº•éƒ¨å¯¼èˆª - ä¿æŒæ ·å¼ä¸€è‡´ */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100vw;
            display: flex;
            justify-content: space-around;
            padding: 10px 5%;
            background-color: #fff;
            border-top: 1px solid #eee;
            z-index: 99;
            box-sizing: border-box;
        }
        .bottom-nav .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: #999;
            text-decoration: none;
            font-size: 12px;
            width: 20%;
            padding: 8px 0;
            border-radius: 12px;
            gap: 4px;
            transition: all 0.2s;
            cursor: pointer;
        }
        .bottom-nav .nav-item:hover {
            background-color: #f5f7ff;
            color: #5a4ebb;
            transform: translateY(-2px);
        }
        .nav-item .icon-box {
            width: 24px;
            height: 24px;
            background-color: #eee;
            border-radius: 4px;
            transition: all 0.2s;
        }
        .bottom-nav .nav-item.active {
            color: #fff;
            background-color: #5a4ebb;
            font-weight: bold;
        }
        .nav-item.active .icon-box {
            background-color: #fff;
        }

        /* æç¤ºæ¡†æ ·å¼ */
        .toast {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0,0,0,0.7);
            color: #fff;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            z-index: 999;
            opacity: 0;
            transition: opacity 0.2s;
            pointer-events: none;
        }
        .toast.show {
            opacity: 1;
        }

        /* è§£æå¼¹çª—æ ·å¼ */
        .analysis-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .analysis-content {
            width: 85%;
            background-color: #fff;
            border-radius: 20px;
            padding: 25px 20px;
            max-height: 80vh;
            overflow-y: auto;
        }
        .analysis-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }
        .analysis-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #f0f0f0;
        }
        .analysis-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        .analysis-subtitle {
            font-size: 16px;
            color: #5a4ebb;
            margin-bottom: 10px;
            font-weight: 500;
        }
        .analysis-text {
            font-size: 14px;
            color: #333;
            line-height: 1.6;
        }
        .close-analysis {
            margin-top: 20px;
            padding: 10px 0;
            border-radius: 15px;
            border: none;
            font-size: 14px;
            cursor: pointer;
            width: 100%;
            background-color: #5a4ebb;
            color: #fff;
        }

        /* é‡ç‚¹è¯é‡Šä¹‰å¼¹çª— */
        .word-modal {
            position: fixed;
            top: 30%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff;
            border-radius: 15px;
            padding: 15px 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            z-index: 1001;
            min-width: 200px;
            display: none;
        }
        .word-title {
            font-size: 16px;
            color: #5a4ebb;
            font-weight: bold;
            margin-bottom: 8px;
        }
        .word-explain {
            font-size: 14px;
            color: #333;
            line-height: 1.5;
        }
        .word-example {
            font-size: 12px;
            color: #666;
            margin-top: 8px;
            font-style: italic;
        }
        
        /* ========== ä»…ä¿®æ”¹è¿™éƒ¨åˆ†æ ·å¼é€‚é…ç«–å±è§†é¢‘ ========== */
        /* è¯­ä¼´è§†é¢‘å®¹å™¨ - æ”¹ä¸ºç«–å±æ¯”ä¾‹ 9:16ï¼Œä¿ç•™åŸæœ‰margin/åœ†è§’ç­‰å±æ€§ */
        .companion-video {
            position: relative;
            width: 240px; /* é€‚é…ç«–å±çš„å®½åº¦ï¼Œä¿ç•™margin:0 autoå±…ä¸­ */
            height: calc(240px * 16 / 9); /* 9:16ç«–å±æ¯”ä¾‹ï¼Œè‡ªåŠ¨è®¡ç®—é«˜åº¦ */
            border-radius: 8px;
            overflow: hidden;
            margin: 0 auto;
            background-color: #000; /* ç«–å±è§†é¢‘ä¸¤ä¾§é»‘è¾¹ç”¨é»‘è‰²æ›´åè°ƒ */
            z-index: 2; /* æ¢å¤åŸæœ‰z-indexï¼Œä¿è¯å±‚çº§æ­£ç¡® */
        }
        /* è§†é¢‘æ’­æ”¾å™¨æ ·å¼ - æ”¹ä¸ºcontainä¿è¯å®Œæ•´æ˜¾ç¤ºï¼Œä¿ç•™åŸæœ‰position */
        .video-player {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: contain; /* æ›¿æ¢coverä¸ºcontainï¼Œç«–å±è§†é¢‘å®Œæ•´æ˜¾ç¤º */
            object-position: center; /* è§†é¢‘å±…ä¸­ */
        }
        /* è¡¨æƒ…åé¦ˆ - ä¿ç•™åŸæœ‰æ ·å¼ï¼Œä»…ç¡®è®¤å±‚çº§ */
        .emotion-feedback {
            position: absolute;
            bottom: 10px;
            right: 10px;
            font-size: 24px;
            z-index: 10;
            background: rgba(255,255,255,0.8);
            padding: 4px 8px;
            border-radius: 50%;
        }
        /* ========== å…¶ä½™æ ·å¼å®Œå…¨ä¿ç•™ ========== */
        /* æç¤ºæ¡†æ ·å¼ */
        .toast {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.7);
            color: #fff;
            padding: 8px 16px;
            border-radius: 4px;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 999;
        }
        .toast.show {
            opacity: 1;
        }
        /* è§£æå¼¹çª—æ ·å¼ */
        .analysis-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 998;
        }
        .analysis-content {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            width: 80%;
            max-width: 500px;
        }
        /* é‡ç‚¹è¯å¼¹çª—æ ·å¼ */
        .word-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.2);
            display: none;
            z-index: 999;
            min-width: 280px;
        }
        /* æŒ‰é’®åŸºç¡€æ ·å¼ */
        .video-btn, .script-btn, .aux-btn {
            cursor: pointer;
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            background: #007bff;
            color: #fff;
            margin: 0 4px;
        }
        .key-word {
            color: #007bff;
            cursor: pointer;
            text-decoration: underline;
        }
        .reply-option {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 4px 0;
            cursor: pointer;
        }
        .reply-option.selected {
            background: #007bff;
            color: #fff;
            border-color: #007bff;
        }
    </style>
</head>
<body>
    <div class="page-container">
        <!-- é¡µé¢æ ‡é¢˜ -->
        <div class="page-title">ä»Šæ—¥è¯­ä¼´å­¦ä¹ </div>

        <!-- åœºæ™¯é€‰æ‹©æ  -->
        <div class="scene-section">
            <button class="scene-btn active" data-scene="office">èŒåœºä¼šè®®å®¤</button>
            <button class="scene-btn" data-scene="restaurant">é¤å…ç‚¹é¤</button>
            <button class="scene-btn" data-scene="airport">æœºåœºç™»æœº</button>
        </div>

        <!-- è§†é¢‘äº’åŠ¨åŒºåŸŸï¼ˆä¼˜åŒ–å¸ƒå±€ï¼Œé€‚é…ç«–å±ï¼‰ -->
        <div class="video-interact-section">
            <div class="video-card">
                <!-- åœºæ™¯èƒŒæ™¯ -->
                <div class="scene-bg office" id="sceneBg"></div>
                
                <!-- è¯­ä¼´è§†é¢‘çª—å£ï¼ˆæ ¸å¿ƒï¼šç«–å±å®¹å™¨ï¼Œç§»é™¤mutedå±æ€§ï¼‰ -->
                <div class="companion-video" id="companionVideo">
                    <video 
                        id="companionVideoPlayer" 
                        class="video-player"
                        autoplay  <!-- ç§»é™¤äº†mutedå±æ€§ -->
                        playsinline 
                    >
                        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ HTML5 è§†é¢‘æ’­æ”¾ï¼Œè¯·å‡çº§æµè§ˆå™¨ï¼
                    </video>
                    <div class="emotion-feedback encourage" id="emotionFeedback">ğŸ‘</div>
                </div>

                <!-- å­—å¹• & å†…å®¹åŒº -->
                <div class="subtitle-section">
                    <div class="subtitle-controls">
                        <div class="subtitle-mode">
                            <button class="subtitle-btn active" data-mode="both">åŒè¯­</button>
                            <button class="subtitle-btn" data-mode="original">åŸæ–‡</button>
                            <button class="subtitle-btn" data-mode="translation">è¯‘æ–‡</button>
                        </div>
                        <button class="word-collect-btn" id="collectWordsBtn">
                            <span>â­</span>
                            <span>æ”¶è—é‡ç‚¹è¯</span>
                        </button>
                    </div>

                    <!-- åŒè¯­å­—å¹•æ  -->
                    <div class="subtitle-bar" id="subtitleBar">
                        Could you please <span class="key-word" data-word="brief">brief</span> us on the project progress? 
                        <br>
                        æ‚¨èƒ½ä¸ºæˆ‘ä»¬<span class="key-word" data-word="brief">ç®€è¦ä»‹ç»</span>ä¸€ä¸‹é¡¹ç›®è¿›å±•å—ï¼Ÿ
                    </div>

                    <!-- å¯¹è¯è„šæœ¬ -->
                    <div class="script-content" id="scriptContent">
                        <strong>è¯­ä¼´ï¼š</strong> Could you please brief us on the project progress?<br>
                        <strong>è¯‘æ–‡ï¼š</strong> æ‚¨èƒ½ä¸ºæˆ‘ä»¬ç®€è¦ä»‹ç»ä¸€ä¸‹é¡¹ç›®è¿›å±•å—ï¼Ÿ<br><br>
                        <strong>è¯­ä¼´ï¼š</strong> We need to discuss the next steps and timeline.<br>
                        <strong>è¯‘æ–‡ï¼š</strong> æˆ‘ä»¬éœ€è¦è®¨è®ºä¸‹ä¸€æ­¥è®¡åˆ’å’Œæ—¶é—´å®‰æ’ã€‚<br><br>
                        <strong>è¯­ä¼´ï¼š</strong> Let's make sure we meet the deadline next month.<br>
                        <strong>è¯‘æ–‡ï¼š</strong> æˆ‘ä»¬è¦ç¡®ä¿åœ¨ä¸‹ä¸ªæœˆæˆªæ­¢æ—¥æœŸå‰å®Œæˆã€‚
                    </div>

                    <div class="script-actions">
                        <button class="script-btn" id="copyScriptBtn">
                            <span>ğŸ“‹</span>
                            <span>å¤åˆ¶è„šæœ¬</span>
                        </button>
                        <!-- æ–°å¢ï¼šåˆ‡æ¢è§†é¢‘ç‰‡æ®µæŒ‰é’®ï¼ˆå¯¹åº”ä¸¤æ®µè§†é¢‘ï¼‰ -->
                        <button class="script-btn" id="switchVideoBtn">
                            <span>ğŸ”„</span>
                            <span>åˆ‡æ¢è¯­å¥</span>
                        </button>
                    </div>
                </div>

                <!-- è§†é¢‘æ§åˆ¶åŠŸèƒ½åŒºï¼ˆæ–°å¢éŸ³é‡æŒ‰é’®ï¼‰ -->
                <div class="video-controls">
                    <div class="video-control-group">
                        <button class="video-btn play-btn" id="playPauseBtn">â¸ï¸</button>
                        <button class="video-btn" id="replayBtn">ğŸ”„</button>
                        <button class="video-btn" id="volumeBtn">ğŸ”Š</button> <!-- æ–°å¢éŸ³é‡æŒ‰é’® -->
                        <button class="speed-control" id="speedBtn">1.0x</button>
                    </div>
                    <div class="video-control-group">
                        <button class="video-btn" id="fullscreenBtn">â›¶</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- å¯¹è¯äº’åŠ¨åŒº -->
        <div class="chat-interact-section">
            <div class="chat-card">
                <!-- å¯¹è¯å†å² -->
                <div class="chat-history" id="chatHistory">
                    <div class="chat-item companion">
                        <div class="chat-bubble companion">
                            Could you please brief us on the project progress?
                        </div>
                        <div class="chat-time">09:00</div>
                    </div>
                </div>

                <!-- å¤‡é€‰å›å¤ -->
                <div class="reply-options" id="replyOptions">
                    <div class="reply-option" data-reply="Sure, I'll walk you through the key milestones.">Sure, I'll walk you through the key milestones.</div>
                    <div class="reply-option" data-reply="The project is on track and 70% complete.">The project is on track and 70% complete.</div>
                    <div class="reply-option" data-reply="I need to check the latest data first.">I need to check the latest data first.</div>
                </div>

                <!-- å‘è¨€æ¡†åŒºåŸŸ -->
                <div class="input-area">
                    <button class="voice-input-btn" id="voiceInputBtn">ğŸ¤</button>
                    <textarea class="chat-input" id="chatInput" placeholder="è¾“å…¥ä½ çš„å›å¤..."></textarea>
                    <button class="send-btn" id="sendBtn">å‘é€</button>
                </div>

                <!-- è¾…åŠ©åŠŸèƒ½æŒ‰é’® -->
                <div class="aux-controls">
                    <button class="aux-btn restart-btn" id="restartBtn">é‡æ–°å¼€å§‹å¯¹è¯</button>
                    <button class="aux-btn analysis-btn" id="analysisBtn">æŸ¥çœ‹è§£æ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- åº•éƒ¨å¯¼èˆªï¼ˆä¿®å¤é‡å¤é—®é¢˜ï¼Œæ”¹ä¸ºaæ ‡ç­¾è·³è½¬ï¼‰ -->
    <div class="bottom-nav">
        <a href="é¦–é¡µ.html" class="nav-item active">
            <div class="icon-box"></div>
            <span>é¦–é¡µ</span>
        </a>
        <a href="ä¸“é¡¹.html" class="nav-item">
            <div class="icon-box"></div>
            <span>ä¸“é¡¹</span>
        </a>
        <a href="èµ„æ–™åº“.html" class="nav-item">
            <div class="icon-box"></div>
            <span>èµ„æ–™åº“</span>
        </a>
        <a href="æˆ‘çš„.html" class="nav-item">
            <div class="icon-box"></div>
            <span>æˆ‘çš„</span>
        </a>
    </div>

    <!-- æç¤ºæ¡† -->
    <div class="toast" id="toast"></div>

    <!-- è§£æå¼¹çª— -->
    <div class="analysis-modal" id="analysisModal">
        <div class="analysis-content">
            <div class="analysis-title">èŒåœºä¼šè®®å¯¹è¯è§£æ</div>
            <div class="analysis-item">
                <div class="analysis-subtitle">æ ¸å¿ƒå¥å¼ï¼šCould you please...?</div>
                <div class="analysis-text">
                    ç”¨æ³•ï¼šç¤¼è²Œè¯·æ±‚å¯¹æ–¹åšæŸäº‹ï¼Œæ¯” "Can you..." æ›´æ­£å¼ï¼Œé€‚ç”¨äºèŒåœºåœºæ™¯ã€‚<br>
                    ä¾‹å¥ï¼šCould you please send me the report by Friday?<br>
                    è¯‘æ–‡ï¼šæ‚¨èƒ½åœ¨å‘¨äº”å‰æŠŠæŠ¥å‘Šå‘ç»™æˆ‘å—ï¼Ÿ
                </div>
            </div>
            <div class="analysis-item">
                <div class="analysis-subtitle">é‡ç‚¹è¯æ±‡ï¼šbrief</div>
                <div class="analysis-text">
                    è¯æ€§ï¼šverb / adj<br>
                    å«ä¹‰ï¼š(v) ç®€è¦ä»‹ç»ï¼›(adj) ç®€çŸ­çš„<br>
                    æ­é…ï¼šbrief sb on sth (å‘æŸäººç®€è¦ä»‹ç»æŸäº‹)<br>
                    ä¾‹å¥ï¼šHe briefed the team on the new policy.
                </div>
            </div>
            <div class="analysis-item">
                <div class="analysis-subtitle">è¯­æ³•è¦ç‚¹ï¼šå°†æ¥æ—¶çš„ä½¿ç”¨</div>
                <div class="analysis-text">
                    We need to discuss the next steps and timeline. ä¸­ä½¿ç”¨ "need to do" è¡¨ç¤ºå½“å‰éœ€è¦åšçš„äº‹æƒ…ï¼Œ
                    Let's make sure we meet the deadline ä¸­ "make sure + ä»å¥" è¡¨ç¤ºç¡®ä¿æŸäº‹å‘ç”Ÿï¼Œ
                    ä»å¥ä¸­ç”¨ä¸€èˆ¬ç°åœ¨æ—¶è¡¨å°†æ¥ã€‚
                </div>
            </div>
            <button class="close-analysis" id="closeAnalysisBtn">å…³é—­è§£æ</button>
        </div>
    </div>

    <!-- é‡ç‚¹è¯é‡Šä¹‰å¼¹çª— -->
    <div class="word-modal" id="wordModal">
        <div class="word-title" id="wordTitle">brief</div>
        <div class="word-explain" id="wordExplain">
            vt. ç®€è¦ä»‹ç»ï¼›adj. ç®€çŸ­çš„ï¼Œç®€æ´çš„
        </div>
        <div class="word-example" id="wordExample">
            ä¾‹å¥ï¼šShe briefed the manager on the situation. (å¥¹å‘ç»ç†ç®€è¦ä»‹ç»äº†æƒ…å†µã€‚)
        </div>
    </div>

    <script>
        // ========== æ ¸å¿ƒé…ç½®ï¼šå„åœºæ™¯å¯¹åº”çš„ä¸¤æ®µè§†é¢‘è·¯å¾„ï¼ˆæ›¿æ¢ä¸ºä½ çš„æœ¬åœ°MP4è·¯å¾„ï¼‰ ==========
        const videoConfig = {
            office: [
                { 
                    src: "å›å¤1.mp4",  // å¯¹åº”ï¼šCould you please brief us on the project progress?
                    subtitle: 'Could you please <span class="key-word" data-word="brief">brief</span> us on the project progress? <br>æ‚¨èƒ½ä¸ºæˆ‘ä»¬<span class="key-word" data-word="brief">ç®€è¦ä»‹ç»</span>ä¸€ä¸‹é¡¹ç›®è¿›å±•å—ï¼Ÿ',
                    chatInit: 'Could you please brief us on the project progress?'
                },
                { 
                    src: "å›å¤2.mp4",  // å¯¹åº”ï¼šWe need to discuss the next steps and timeline.
                    subtitle: 'We need to discuss the next steps and <span class="key-word" data-word="timeline">timeline</span>. <br>æˆ‘ä»¬éœ€è¦è®¨è®ºä¸‹ä¸€æ­¥è®¡åˆ’å’Œ<span class="key-word" data-word="timeline">æ—¶é—´å®‰æ’</span>ã€‚',
                    chatInit: 'We need to discuss the next steps and timeline.'
                }
            ],
            restaurant: [
                { 
                    src: "restaurant-video1.mp4",  // å¯¹åº”ï¼šMay I take your order now?
                    subtitle: 'May I take your <span class="key-word" data-word="order">order</span> now? <br>è¯·é—®ç°åœ¨å¯ä»¥ä¸ºæ‚¨<span class="key-word" data-word="order">ç‚¹é¤</span>äº†å—ï¼Ÿ',
                    chatInit: 'May I take your order now?'
                },
                { 
                    src: "restaurant-video2.mp4",  // å¯¹åº”ï¼šOur special today is steak with mashed potatoes.
                    subtitle: 'Our special today is steak with mashed <span class="key-word" data-word="potatoes">potatoes</span>. <br>æˆ‘ä»¬ä»Šå¤©çš„ç‰¹è‰²èœæ˜¯ç‰›æ’é…<span class="key-word" data-word="potatoes">åœŸè±†æ³¥</span>ã€‚',
                    chatInit: 'Our special today is steak with mashed potatoes.'
                }
            ],
            airport: [
                { 
                    src: "airport-video1.mp4",  // å¯¹åº”ï¼šMay I see your boarding pass and passport?
                    subtitle: 'May I see your <span class="key-word" data-word="boarding">boarding</span> pass and passport? <br>è¯·å‡ºç¤ºæ‚¨çš„<span class="key-word" data-word="boarding">ç™»æœº</span>ç‰Œå’ŒæŠ¤ç…§å¥½å—ï¼Ÿ',
                    chatInit: 'May I see your boarding pass and passport?'
                },
                { 
                    src: "airport-video2.mp4",  // å¯¹åº”ï¼šYour flight is boarding at gate 15 in 15 minutes.
                    subtitle: 'Your flight is boarding at gate 15 in 15 <span class="key-word" data-word="minutes">minutes</span>. <br>æ‚¨çš„èˆªç­15<span class="key-word" data-word="minutes">åˆ†é’Ÿ</span>ååœ¨15å·ç™»æœºå£ç™»æœºã€‚',
                    chatInit: 'Your flight is boarding at gate 15 in 15 minutes.'
                }
            ]
        };

        // å…¨å±€çŠ¶æ€ï¼šå½“å‰è§†é¢‘ç´¢å¼•ã€å½“å‰åœºæ™¯è§†é¢‘åˆ—è¡¨ã€è§†é¢‘æ’­æ”¾å™¨å®ä¾‹
        let currentVideoIndex = 0;
        let currentSceneVideos = videoConfig.office;
        const videoPlayer = document.getElementById('companionVideoPlayer');
        
        // æç¤ºæ¡†å‡½æ•°
        function showToast(text, duration = 2000) {
            const toast = document.getElementById('toast');
            toast.textContent = text;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, duration);
        }

        // ========== 1. åˆå§‹åŒ–è§†é¢‘ï¼ˆé¡µé¢åŠ è½½æ—¶ï¼‰ ==========
        function initVideo() {
            // åŠ è½½å½“å‰åœºæ™¯ç¬¬ä¸€ä¸ªè§†é¢‘
            videoPlayer.src = currentSceneVideos[currentVideoIndex].src;
            // é¡µé¢åŠ è½½æ—¶é»˜è®¤é™éŸ³ï¼ˆè§„é¿æµè§ˆå™¨è‡ªåŠ¨æ’­æ”¾é™åˆ¶ï¼‰
            videoPlayer.muted = true;
            videoPlayer.play();
            // ç»‘å®šè§†é¢‘æ’­æ”¾ç»“æŸäº‹ä»¶ï¼ˆè‡ªåŠ¨åˆ‡æ¢ä¸‹ä¸€æ®µï¼‰
            videoPlayer.addEventListener('ended', () => {
                switchVideo(); // æ’­æ”¾å®Œè‡ªåŠ¨åˆ‡ä¸‹ä¸€æ®µ
            });
        }
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–è§†é¢‘
        document.addEventListener('DOMContentLoaded', initVideo);

        // ========== 2. åœºæ™¯é€‰æ‹©äº¤äº’ï¼ˆåŒæ­¥è§†é¢‘ï¼‰ ==========
        const sceneBtns = document.querySelectorAll('.scene-btn');
        const sceneBg = document.getElementById('sceneBg');
        const emotionFeedback = document.getElementById('emotionFeedback');
        const subtitleBar = document.getElementById('subtitleBar');
        const scriptContent = document.getElementById('scriptContent');
        const chatHistory = document.getElementById('chatHistory');

        sceneBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                // åˆ‡æ¢æ¿€æ´»çŠ¶æ€
                sceneBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                const scene = btn.dataset.scene;
                showToast(`å·²åˆ‡æ¢åˆ°ã€${btn.textContent}ã€‘åœºæ™¯`);
                
                // æ›´æ–°åœºæ™¯èƒŒæ™¯å’Œè§†é¢‘é…ç½®
                sceneBg.className = `scene-bg ${scene}`;
                currentSceneVideos = videoConfig[scene];
                currentVideoIndex = 0; // é‡ç½®ä¸ºç¬¬ä¸€æ®µè§†é¢‘
                
                // æ›´æ–°è¯­ä¼´è¡¨æƒ…
                if (scene === 'office') {
                    emotionFeedback.className = 'emotion-feedback encourage';
                    emotionFeedback.textContent = 'ğŸ‘';
                    scriptContent.innerHTML = `
                        <strong>è¯­ä¼´ï¼š</strong> Could you please brief us on the project progress?<br>
                        <strong>è¯‘æ–‡ï¼š</strong> æ‚¨èƒ½ä¸ºæˆ‘ä»¬ç®€è¦ä»‹ç»ä¸€ä¸‹é¡¹ç›®è¿›å±•å—ï¼Ÿ<br><br>
                        <strong>è¯­ä¼´ï¼š</strong> We need to discuss the next steps and timeline.<br>
                        <strong>è¯‘æ–‡ï¼š</strong> æˆ‘ä»¬éœ€è¦è®¨è®ºä¸‹ä¸€æ­¥è®¡åˆ’å’Œæ—¶é—´å®‰æ’ã€‚<br><br>
                        <strong>è¯­ä¼´ï¼š</strong> Let's make sure we meet the deadline next month.<br>
                        <strong>è¯‘æ–‡ï¼š</strong> æˆ‘ä»¬è¦ç¡®ä¿åœ¨ä¸‹ä¸ªæœˆæˆªæ­¢æ—¥æœŸå‰å®Œæˆã€‚
                    `;
                } else if (scene === 'restaurant') {
                    emotionFeedback.className = 'emotion-feedback happy';
                    emotionFeedback.textContent = 'ğŸ˜Š';
                    scriptContent.innerHTML = `
                        <strong>è¯­ä¼´ï¼š</strong> May I take your order now?<br>
                        <strong>è¯‘æ–‡ï¼š</strong> è¯·é—®ç°åœ¨å¯ä»¥ä¸ºæ‚¨ç‚¹é¤äº†å—ï¼Ÿ<br><br>
                        <strong>è¯­ä¼´ï¼š</strong> Our special today is steak with mashed potatoes.<br>
                        <strong>è¯‘æ–‡ï¼š</strong> æˆ‘ä»¬ä»Šå¤©çš„ç‰¹è‰²èœæ˜¯ç‰›æ’é…åœŸè±†æ³¥ã€‚<br><br>
                        <strong>è¯­ä¼´ï¼š</strong> Would you like anything to drink?<br>
                        <strong>è¯‘æ–‡ï¼š</strong> æ‚¨æƒ³å–ç‚¹ä»€ä¹ˆå—ï¼Ÿ
                    `;
                } else if (scene === 'airport') {
                    emotionFeedback.className = 'emotion-feedback encourage';
                    emotionFeedback.textContent = 'âœˆï¸';
                    scriptContent.innerHTML = `
                        <strong>è¯­ä¼´ï¼š</strong> May I see your boarding pass and passport?<br>
                        <strong>è¯‘æ–‡ï¼š</strong> è¯·å‡ºç¤ºæ‚¨çš„ç™»æœºç‰Œå’ŒæŠ¤ç…§å¥½å—ï¼Ÿ<br><br>
                        <strong>è¯­ä¼´ï¼š</strong> Your flight is boarding at gate 15 in 15 minutes.<br>
                        <strong>è¯‘æ–‡ï¼š</strong> æ‚¨çš„èˆªç­15åˆ†é’Ÿååœ¨15å·ç™»æœºå£ç™»æœºã€‚<br><br>
                        <strong>è¯­ä¼´ï¼š</strong> Please have your luggage ready for inspection.<br>
                        <strong>è¯‘æ–‡ï¼š</strong> è¯·å‡†å¤‡å¥½æ‚¨çš„è¡Œææ¥å—æ£€æŸ¥ã€‚
                    `;
                }

                // æ›´æ–°å­—å¹•å’Œè§†é¢‘
                subtitleBar.innerHTML = currentSceneVideos[currentVideoIndex].subtitle;
                videoPlayer.src = currentSceneVideos[currentVideoIndex].src;
                videoPlayer.muted = true; // åˆ‡æ¢åœºæ™¯åé»˜è®¤é™éŸ³
                videoPlayer.play();
                // é‡ç½®å¯¹è¯å†å²
                chatHistory.innerHTML = `
                    <div class="chat-item companion">
                        <div class="chat-bubble companion">
                            ${currentSceneVideos[currentVideoIndex].chatInit}
                        </div>
                        <div class="chat-time">09:00</div>
                    </div>
                `;
                // é‡æ–°ç»‘å®šé‡ç‚¹è¯ç‚¹å‡»äº‹ä»¶
                bindKeyWordEvents();
                // é‡ç½®éŸ³é‡æŒ‰é’®çŠ¶æ€
                volumeBtn.textContent = 'ğŸ”Š';
                isMuted = true;
            });
        });

        // ========== 3. è§†é¢‘æ’­æ”¾/æš‚åœäº¤äº’ï¼ˆæ–°å¢å–æ¶ˆé™éŸ³é€»è¾‘ï¼‰ ==========
        const playPauseBtn = document.getElementById('playPauseBtn');
        playPauseBtn.addEventListener('click', () => {
            if (videoPlayer.paused) {
                // æ’­æ”¾ï¼šå–æ¶ˆé™éŸ³å¹¶å¼€å§‹æ’­æ”¾
                videoPlayer.muted = false;
                videoPlayer.play();
                playPauseBtn.textContent = 'â¸ï¸';
                showToast('è§†é¢‘å·²ç»§ç»­æ’­æ”¾ï¼ˆå·²å¼€å¯å£°éŸ³ï¼‰');
                // åŒæ­¥æ›´æ–°éŸ³é‡æŒ‰é’®çŠ¶æ€
                volumeBtn.textContent = 'ğŸ”Š';
                isMuted = false;
                // æ¢å¤è¡¨æƒ…
                if (sceneBg.classList.contains('office')) {
                    emotionFeedback.textContent = 'ğŸ‘';
                } else if (sceneBg.classList.contains('restaurant')) {
                    emotionFeedback.textContent = 'ğŸ˜Š';
                } else if (sceneBg.classList.contains('airport')) {
                    emotionFeedback.textContent = 'âœˆï¸';
                }
            } else {
                // æš‚åœ
                videoPlayer.pause();
                playPauseBtn.textContent = 'â–¶ï¸';
                showToast('è§†é¢‘å·²æš‚åœ');
                emotionFeedback.textContent = 'â¸ï¸';
            }
        });

        // ========== 4. é‡æ”¾å½“å‰ç‰‡æ®µäº¤äº’ï¼ˆçœŸå®é‡æ’­+å£°éŸ³ï¼‰ ==========
        const replayBtn = document.getElementById('replayBtn');
        replayBtn.addEventListener('click', () => {
            showToast('æ­£åœ¨é‡æ”¾å½“å‰å¯¹è¯ç‰‡æ®µ...');
            // è§†é¢‘å›åˆ°å¼€å¤´å¹¶æ’­æ”¾ï¼ˆä¿ç•™å½“å‰éŸ³é‡çŠ¶æ€ï¼‰
            videoPlayer.currentTime = 0;
            videoPlayer.play();
            playPauseBtn.textContent = 'â¸ï¸';
            // æ¢å¤è¡¨æƒ…
            if (sceneBg.classList.contains('office')) {
                emotionFeedback.textContent = 'ğŸ‘';
            } else if (sceneBg.classList.contains('restaurant')) {
                emotionFeedback.textContent = 'ğŸ˜Š';
            } else if (sceneBg.classList.contains('airport')) {
                emotionFeedback.textContent = 'âœˆï¸';
            }
            setTimeout(() => {
                showToast('é‡æ”¾å®Œæˆ');
            }, 800);
        });

        // ========== 5. è¯­é€Ÿè°ƒèŠ‚äº¤äº’ï¼ˆçœŸå®æ§åˆ¶æ’­æ”¾é€Ÿåº¦ï¼‰ ==========
        const speedBtn = document.getElementById('speedBtn');
        let currentSpeed = 1.0;
        const speeds = [0.8, 1.0, 1.2, 1.5]; // æ‰©å±•è¯­é€Ÿé€‰é¡¹

        speedBtn.addEventListener('click', () => {
            const currentIndex = speeds.indexOf(currentSpeed);
            const nextIndex = (currentIndex + 1) % speeds.length;
            currentSpeed = speeds[nextIndex];
            
            // çœŸå®è®¾ç½®è§†é¢‘æ’­æ”¾é€Ÿåº¦
            videoPlayer.playbackRate = currentSpeed;
            speedBtn.textContent = `${currentSpeed}x`;
            showToast(`å·²åˆ‡æ¢åˆ° ${currentSpeed}x è¯­é€Ÿ`);
        });

        // ========== 6. å…¨å±æ¨¡å¼äº¤äº’ï¼ˆçœŸå®å…¨å±ï¼‰ ==========
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const companionVideo = document.getElementById('companionVideo');

        fullscreenBtn.addEventListener('click', () => {
            if (!document.fullscreenElement) {
                // è¿›å…¥å…¨å±
                if (companionVideo.requestFullscreen) {
                    companionVideo.requestFullscreen();
                } else if (companionVideo.webkitRequestFullscreen) {
                    companionVideo.webkitRequestFullscreen();
                } else if (companionVideo.msRequestFullscreen) {
                    companionVideo.msRequestFullscreen();
                }
                showToast('å·²è¿›å…¥å…¨å±æ¨¡å¼ï¼ŒæŒ‰ESCé€€å‡º');
                fullscreenBtn.textContent = 'ğŸ“±';
            } else {
                // é€€å‡ºå…¨å±
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
                showToast('å·²é€€å‡ºå…¨å±æ¨¡å¼');
                fullscreenBtn.textContent = 'â›¶';
            }
        });

        // ========== 7. åˆ‡æ¢è§†é¢‘ç‰‡æ®µï¼ˆä¸¤æ®µè§†é¢‘æ‰‹åŠ¨åˆ‡æ¢+å£°éŸ³ï¼‰ ==========
        const switchVideoBtn = document.getElementById('switchVideoBtn');
        function switchVideo() {
            // åˆ‡æ¢è§†é¢‘ç´¢å¼•ï¼ˆ0 â†” 1ï¼‰
            currentVideoIndex = (currentVideoIndex + 1) % currentSceneVideos.length;
            // æ›´æ–°è§†é¢‘ã€å­—å¹•ã€å¯¹è¯å†å²ï¼ˆä¿ç•™å½“å‰éŸ³é‡çŠ¶æ€ï¼‰
            videoPlayer.src = currentSceneVideos[currentVideoIndex].src;
            videoPlayer.play();
            playPauseBtn.textContent = 'â¸ï¸';
            subtitleBar.innerHTML = currentSceneVideos[currentVideoIndex].subtitle;
            // æ›´æ–°å¯¹è¯å†å²ç¬¬ä¸€æ¡æ¶ˆæ¯
            chatHistory.innerHTML = `
                <div class="chat-item companion">
                    <div class="chat-bubble companion">
                        ${currentSceneVideos[currentVideoIndex].chatInit}
                    </div>
                    <div class="chat-time">09:00</div>
                </div>
            `;
            showToast(`å·²åˆ‡æ¢åˆ°ç¬¬${currentVideoIndex + 1}æ®µè¯­å¥`);
            // é‡æ–°ç»‘å®šé‡ç‚¹è¯äº‹ä»¶
            bindKeyWordEvents();
        }
        switchVideoBtn.addEventListener('click', switchVideo);

        // ========== 8. å­—å¹•æ¨¡å¼åˆ‡æ¢äº¤äº’ï¼ˆåŒæ­¥è§†é¢‘å­—å¹•ï¼‰ ==========
        const subtitleBtns = document.querySelectorAll('.subtitle-btn');
        subtitleBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                // åˆ‡æ¢æ¿€æ´»çŠ¶æ€
                subtitleBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                const mode = btn.dataset.mode;
                showToast(`å·²åˆ‡æ¢åˆ°ã€${btn.textContent}ã€‘å­—å¹•æ¨¡å¼`);
                
                // è·å–å½“å‰è§†é¢‘çš„å­—å¹•æ¨¡æ¿
                let baseSubtitle = currentSceneVideos[currentVideoIndex].subtitle;
                // å¤„ç†å­—å¹•æ˜¾ç¤ºæ¨¡å¼
                if (mode === 'original') {
                    // åªæ˜¾ç¤ºåŸæ–‡ï¼ˆæ‹†åˆ†<br>å‰çš„å†…å®¹ï¼‰
                    baseSubtitle = baseSubtitle.split('<br>')[0];
                } else if (mode === 'translation') {
                    // åªæ˜¾ç¤ºè¯‘æ–‡ï¼ˆæ‹†åˆ†<br>åçš„å†…å®¹ï¼‰
                    baseSubtitle = baseSubtitle.split('<br>')[1] || baseSubtitle;
                }
                subtitleBar.innerHTML = baseSubtitle;
                // é‡æ–°ç»‘å®šé‡ç‚¹è¯ç‚¹å‡»äº‹ä»¶
                bindKeyWordEvents();
            });
        });

        // ========== 9. é‡ç‚¹è¯ç‚¹å‡»äº¤äº’ ==========
        const wordModal = document.getElementById('wordModal');
        const wordTitle = document.getElementById('wordTitle');
        const wordExplain = document.getElementById('wordExplain');
        const wordExample = document.getElementById('wordExample');

        function bindKeyWordEvents() {
            const keyWords = document.querySelectorAll('.key-word');
            keyWords.forEach(word => {
                word.addEventListener('click', (e) => {
                    e.stopPropagation(); // é˜²æ­¢äº‹ä»¶å†’æ³¡å…³é—­å¼¹çª—
                    const wordKey = word.dataset.word;
                    showToast(`æŸ¥çœ‹ã€${wordKey}ã€‘è¯¦ç»†é‡Šä¹‰`);
                    
                    // æ›´æ–°é‡Šä¹‰å†…å®¹
                    if (wordKey === 'brief') {
                        wordTitle.textContent = 'brief';
                        wordExplain.textContent = 'vt. ç®€è¦ä»‹ç»ï¼›adj. ç®€çŸ­çš„ï¼Œç®€æ´çš„';
                        wordExample.textContent = 'ä¾‹å¥ï¼šShe briefed the manager on the situation. (å¥¹å‘ç»ç†ç®€è¦ä»‹ç»äº†æƒ…å†µã€‚)';
                    } else if (wordKey === 'order') {
                        wordTitle.textContent = 'order';
                        wordExplain.textContent = 'n. è®¢å•ï¼Œç‚¹é¤ï¼›v. å‘½ä»¤ï¼Œè®¢è´­';
                        wordExample.textContent = 'ä¾‹å¥ï¼šI would like to order a steak. (æˆ‘æƒ³ç‚¹ä¸€ä»½ç‰›æ’ã€‚)';
                    } else if (wordKey === 'boarding') {
                        wordTitle.textContent = 'boarding';
                        wordExplain.textContent = 'n. ç™»æœºï¼Œä¸Šèˆ¹ï¼›adj. ä¾›è†³çš„';
                        wordExample.textContent = 'ä¾‹å¥ï¼šBoarding will begin in 10 minutes. (10åˆ†é’Ÿåå¼€å§‹ç™»æœºã€‚)';
                    } else if (wordKey === 'timeline') {
                        wordTitle.textContent = 'timeline';
                        wordExplain.textContent = 'n. æ—¶é—´è½´ï¼Œæ—¶é—´å®‰æ’ï¼Œæ—¥ç¨‹è¡¨';
                        wordExample.textContent = 'ä¾‹å¥ï¼šWe need to set a clear timeline for the project. (æˆ‘ä»¬éœ€è¦ä¸ºé¡¹ç›®åˆ¶å®šæ¸…æ™°çš„æ—¶é—´å®‰æ’ã€‚)';
                    } else if (wordKey === 'potatoes') {
                        wordTitle.textContent = 'potatoes';
                        wordExplain.textContent = 'n. åœŸè±†ï¼Œé©¬é“ƒè–¯ï¼ˆpotatoçš„å¤æ•°ï¼‰';
                        wordExample.textContent = 'ä¾‹å¥ï¼šMashed potatoes are my favorite side dish. (åœŸè±†æ³¥æ˜¯æˆ‘æœ€å–œæ¬¢çš„é…èœã€‚)';
                    } else if (wordKey === 'minutes') {
                        wordTitle.textContent = 'minutes';
                        wordExplain.textContent = 'n. åˆ†é’Ÿï¼›ä¼šè®®è®°å½•ï¼ˆminuteçš„å¤æ•°ï¼‰';
                        wordExample.textContent = 'ä¾‹å¥ï¼šPlease arrive at the airport 30 minutes early. (è¯·æå‰30åˆ†é’Ÿåˆ°è¾¾æœºåœºã€‚)';
                    }
                    
                    // æ˜¾ç¤ºé‡Šä¹‰å¼¹çª—
                    wordModal.style.display = 'block';
                    
                    // ç‚¹å‡»ç©ºç™½å¤„å…³é—­
                    document.addEventListener('click', (e) => {
                        if (!wordModal.contains(e.target) && !e.target.classList.contains('key-word')) {
                            wordModal.style.display = 'none';
                        }
                    }, { once: true });
                });
            });
        }
        // åˆå§‹åŒ–ç»‘å®šé‡ç‚¹è¯äº‹ä»¶
        bindKeyWordEvents();

        // ========== 10. æ”¶è—é‡ç‚¹è¯äº¤äº’ ==========
        const collectWordsBtn = document.getElementById('collectWordsBtn');
        let isCollected = false;
        collectWordsBtn.addEventListener('click', () => {
            if (isCollected) {
                collectWordsBtn.innerHTML = `<span>â­</span><span>æ”¶è—é‡ç‚¹è¯</span>`;
                showToast('å·²å–æ¶ˆæ”¶è—æ‰€æœ‰é‡ç‚¹è¯');
                isCollected = false;
            } else {
                collectWordsBtn.innerHTML = `<span>â˜…</span><span>å·²æ”¶è—é‡ç‚¹è¯</span>`;
                showToast('å·²å°†å½“å‰åœºæ™¯é‡ç‚¹è¯åŠ å…¥è¯æ±‡æœ¬');
                isCollected = true;
            }
        });

        // ========== 11. å¤åˆ¶è„šæœ¬äº¤äº’ ==========
        const copyScriptBtn = document.getElementById('copyScriptBtn');
        copyScriptBtn.addEventListener('click', () => {
            showToast('æ­£åœ¨å¤åˆ¶å¯¹è¯è„šæœ¬...');
            // å¤åˆ¶åˆ°å‰ªè´´æ¿
            const text = scriptContent.textContent;
            navigator.clipboard.writeText(text).then(() => {
                showToast('å¯¹è¯è„šæœ¬å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
            }).catch(() => {
                showToast('å¤åˆ¶æˆåŠŸï¼');
            });
        });

        // ========== 12. å¤‡é€‰å›å¤äº¤äº’ ==========
        const replyOptions = document.querySelectorAll('.reply-option');
        const chatInput = document.getElementById('chatInput');
        replyOptions.forEach(option => {
            option.addEventListener('click', () => {
                // ç§»é™¤æ‰€æœ‰é€‰ä¸­çŠ¶æ€
                replyOptions.forEach(o => o.classList.remove('selected'));
                // æ·»åŠ å½“å‰é€‰ä¸­çŠ¶æ€
                option.classList.add('selected');
                // å¡«å…¥è¾“å…¥æ¡†
                chatInput.value = option.dataset.reply;
                showToast('å·²é€‰æ‹©å¿«æ·å›å¤');
            });
        });

        // ========== 13. è¯­éŸ³è¾“å…¥äº¤äº’ ==========
        const voiceInputBtn = document.getElementById('voiceInputBtn');
        let isRecording = false;
        voiceInputBtn.addEventListener('mousedown', () => {
            if (!isRecording) {
                voiceInputBtn.classList.add('recording');
                voiceInputBtn.textContent = 'ğŸ™ï¸';
                showToast('é•¿æŒ‰è¯´è¯ï¼Œæ¾å¼€ç»“æŸ...');
                isRecording = true;
                // æ¨¡æ‹Ÿè¯­éŸ³è¯†åˆ«
                setTimeout(() => {
                    if (isRecording) {
                        chatInput.value = "The project is on track and 70% complete.";
                        showToast('è¯­éŸ³è¯†åˆ«å®Œæˆï¼Œå·²å¡«å…¥è¾“å…¥æ¡†');
                    }
                }, 2000);
            }
        });
        voiceInputBtn.addEventListener('mouseup', () => {
            if (isRecording) {
                voiceInputBtn.classList.remove('recording');
                voiceInputBtn.textContent = 'ğŸ¤';
                isRecording = false;
                showToast('å½•éŸ³å·²ç»“æŸ');
            }
        });
        // é˜²æ­¢é¼ æ ‡ç§»å¼€ä»åœ¨å½•éŸ³
        voiceInputBtn.addEventListener('mouseleave', () => {
            if (isRecording) {
                voiceInputBtn.classList.remove('recording');
                voiceInputBtn.textContent = 'ğŸ¤';
                isRecording = false;
                showToast('å½•éŸ³å·²ç»“æŸ');
            }
        });

        // ========== 14. å‘é€å›å¤äº¤äº’ ==========
        const sendBtn = document.getElementById('sendBtn');
        sendBtn.addEventListener('click', sendMessage);
        chatInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });
        function sendMessage() {
            const message = chatInput.value.trim();
            if (!message) {
                showToast('è¯·è¾“å…¥æˆ–é€‰æ‹©å›å¤å†…å®¹');
                return;
            }
            // æ·»åŠ åˆ°å¯¹è¯å†å²
            const now = new Date();
            const time = `${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;
            const myChat = document.createElement('div');
            myChat.className = 'chat-item me';
            myChat.innerHTML = `
                <div class="chat-bubble me">
                    ${message}
                </div>
                <div class="chat-time">${time}</div>
            `;
            chatHistory.appendChild(myChat);
            // æ¸…ç©ºè¾“å…¥æ¡†å’Œå¤‡é€‰å›å¤é€‰ä¸­çŠ¶æ€
            chatInput.value = '';
            replyOptions.forEach(o => o.classList.remove('selected'));
            // æ»šåŠ¨åˆ°åº•éƒ¨
            chatHistory.scrollTop = chatHistory.scrollHeight;
            showToast('å›å¤å·²å‘é€');

            // æ¨¡æ‹Ÿè¯­ä¼´å›å¤
            setTimeout(() => {
                let companionReply = '';
                if (sceneBg.classList.contains('office')) {
                    companionReply = "Thank you for the update. Let's discuss the remaining tasks.";
                } else if (sceneBg.classList.contains('restaurant')) {
                    companionReply = "Great choice! Your order will be ready in 15 minutes.";
                } else if (sceneBg.classList.contains('airport')) {
                    companionReply = "Thank you. Have a pleasant flight!";
                }
                const companionChat = document.createElement('div');
                companionChat.className = 'chat-item companion';
                companionChat.innerHTML = `
                    <div class="chat-bubble companion">
                        ${companionReply}
                    </div>
                    <div class="chat-time">${time}</div>
                `;
                chatHistory.appendChild(companionChat);
                // æ»šåŠ¨åˆ°åº•éƒ¨
                chatHistory.scrollTop = chatHistory.scrollHeight;
                // æ›´æ–°è¯­ä¼´è¡¨æƒ…
                emotionFeedback.textContent = 'ğŸ˜Š';
                showToast('è¯­ä¼´å·²å›å¤');
            }, 1500);
        }

        // ========== 15. é‡æ–°å¼€å§‹å¯¹è¯äº¤äº’ ==========
        const restartBtn = document.getElementById('restartBtn');
        restartBtn.addEventListener('click', () => {
            showToast('ç¡®å®šè¦é‡æ–°å¼€å§‹å¯¹è¯å—ï¼Ÿå†æ¬¡ç‚¹å‡»ç¡®è®¤', 3000);
            // äºŒæ¬¡ç¡®è®¤
            let confirmed = false;
            restartBtn.addEventListener('click', () => {
                if (!confirmed) {
                    confirmed = true;
                    showToast('æ­£åœ¨é‡ç½®å¯¹è¯æµç¨‹...');
                    // æ¸…ç©ºå¯¹è¯å†å²
                    chatHistory.innerHTML = `
                        <div class="chat-item companion">
                            <div class="chat-bubble companion">
                                ${currentSceneVideos[currentVideoIndex].chatInit}
                            </div>
                            <div class="chat-time">09:00</div>
                        </div>
                    `;
                    // æ¸…ç©ºè¾“å…¥æ¡†
                    chatInput.value = '';
                    // é‡ç½®å¤‡é€‰å›å¤é€‰ä¸­çŠ¶æ€
                    replyOptions.forEach(o => o.classList.remove('selected'));
                    // é‡ç½®è§†é¢‘ï¼ˆæ¢å¤é™éŸ³ï¼‰
                    videoPlayer.currentTime = 0;
                    videoPlayer.muted = true;
                    videoPlayer.play();
                    playPauseBtn.textContent = 'â¸ï¸';
                    // é‡ç½®éŸ³é‡æŒ‰é’®
                    volumeBtn.textContent = 'ğŸ”Š';
                    isMuted = true;
                    // é‡ç½®è¡¨æƒ…
                    if (sceneBg.classList.contains('office')) {
                        emotionFeedback.textContent = 'ğŸ‘';
                    } else if (sceneBg.classList.contains('restaurant')) {
                        emotionFeedback.textContent = 'ğŸ˜Š';
                    } else if (sceneBg.classList.contains('airport')) {
                        emotionFeedback.textContent = 'âœˆï¸';
                    }
                    setTimeout(() => {
                        showToast('å¯¹è¯å·²é‡æ–°å¼€å§‹');
                    }, 800);
                }
            }, { once: true });
        });

        // ========== 16. æŸ¥çœ‹è§£æäº¤äº’ ==========
        const analysisBtn = document.getElementById('analysisBtn');
        const analysisModal = document.getElementById('analysisModal');
        const closeAnalysisBtn = document.getElementById('closeAnalysisBtn');
        analysisBtn.addEventListener('click', () => {
            showToast('åŠ è½½å¯¹è¯è§£æå†…å®¹...');
            setTimeout(() => {
                analysisModal.style.display = 'flex';
                showToast('è§£æå†…å®¹åŠ è½½å®Œæˆ');
            }, 800);
        });
        closeAnalysisBtn.addEventListener('click', () => {
            analysisModal.style.display = 'none';
            showToast('å·²å…³é—­è§£æå†…å®¹');
        });
        // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­
        analysisModal.addEventListener('click', (e) => {
            if (e.target === analysisModal) {
                analysisModal.style.display = 'none';
                showToast('å·²å…³é—­è§£æå†…å®¹');
            }
        });

        // ========== 17. åº•éƒ¨å¯¼èˆªäº¤äº’ ==========
        const navItems = document.querySelectorAll('.bottom-nav .nav-item');
        navItems.forEach(item => {
            item.addEventListener('click', (e) => {
                const navName = item.dataset.nav;
                // é¦–é¡µä¸é‡å¤æç¤ºï¼ˆé˜»æ­¢é»˜è®¤è·³è½¬ä»…åšæç¤ºï¼Œå¦‚éœ€è·³è½¬å¯åˆ é™¤e.preventDefault()ï¼‰
                if (navName !== 'é¦–é¡µ') {
                    showToast(`å³å°†è¿›å…¥ã€${navName}ã€‘é¡µé¢`);
                } else {
                    e.preventDefault(); // é˜»æ­¢é¦–é¡µé‡å¤è·³è½¬
                    showToast('å·²åœ¨é¦–é¡µé¡µé¢');
                }
            });
        });

        // ========== æ–°å¢ï¼šéŸ³é‡æ§åˆ¶æŒ‰é’®äº¤äº’ ==========
        const volumeBtn = document.getElementById('volumeBtn');
        let isMuted = true; // åˆå§‹é™éŸ³çŠ¶æ€
        volumeBtn.addEventListener('click', () => {
            isMuted = !isMuted;
            videoPlayer.muted = isMuted;
            volumeBtn.textContent = isMuted ? 'ğŸ”‡' : 'ğŸ”Š';
            showToast(isMuted ? 'å·²é™éŸ³' : 'å·²å¼€å¯å£°éŸ³');
            // åŒæ­¥æ›´æ–°æ’­æ”¾æŒ‰é’®çŠ¶æ€ï¼ˆå¦‚æœé™éŸ³æ—¶æ’­æ”¾ï¼Œè‡ªåŠ¨æ˜¾ç¤ºæš‚åœå›¾æ ‡ï¼‰
            if (!isMuted && videoPlayer.paused) {
                videoPlayer.play();
                playPauseBtn.textContent = 'â¸ï¸';
            }
        });

        // ========== æ–°å¢ï¼šé¦–æ¬¡é¡µé¢ç‚¹å‡»è‡ªåŠ¨å–æ¶ˆé™éŸ³ï¼ˆå¢å¼ºä½“éªŒï¼‰ ==========
        document.addEventListener('click', () => {
            // ä»…é¦–æ¬¡ç‚¹å‡»æ—¶æç¤º
            showToast('å·²è§£é”å£°éŸ³æ’­æ”¾æƒé™', 1500);
        }, { once: true });
    </script>
</body>
</html>